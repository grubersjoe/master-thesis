\documentclass[
  abstract=on,
  BCOR=10mm,
  bibliography=totoc,
  listof=totoc,
  headsepline=on,
  numbers=noenddot,
  paper=a4,
  parskip=on,
  twoside=off,
  DIV=11,
  ngerman
]{scrreprt}

\title{Statische Typsysteme für JavaScript}
\subtitle{Entwicklung eines Babel-Plugins zur Transpilierung von Flow nach TypeScript}
\date{\today}
\author{Jonathan Gruber}

% PDF Version 1.7
\pdfminorversion=7

% "Fix" for KOMA script warning about floats
\usepackage{scrhack}

% Encoding
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

% Babel
\usepackage[ngerman]{babel}

% Fonts
\usepackage[tt=false]{libertine}
\usepackage[scale=0.8,nomap,lining]{FiraMono}

% Math
\usepackage[libertine]{newtxmath}

% Set headings in serif as well
\addtokomafont{disposition}{\rmfamily}

% Even better typography
\usepackage{microtype}

% Orphans
\usepackage[all]{nowidow}

% Biber (references)
\usepackage[
  backend=biber,
  backref=true,
  backrefstyle=three+,
  sortlocale=de_DE
]{biblatex}
\addbibresource{src/references.bib}

\DefineBibliographyStrings{german}{
  references = {Quellenverzeichnis}
}

% Use the main font for URLs
\urlstyle{same}

% Endnotes
\usepackage[
  backref=true,
  counter-format=roman,
  totoc=chapter,
]{enotez}

% Use a 1.5 line-height
\usepackage[onehalfspacing]{setspace}

% Header
\usepackage[
  automark,
  autooneside=false
]{scrlayer-scrpage}
\chead{}
\ihead{\leftmark}
\ohead{\rightmark}

% Remove chapter number
\renewcommand\chaptermarkformat{}

% Decrease space after subsubsections
\RedeclareSectionCommand[
  runin=false,
  afterskip=-.25\baselineskip
]{subsubsection}

% Better spacing in lists
\usepackage{enumitem}
% \renewcommand\labelitemi{--}
\setlist{nosep}

% Colors
\usepackage{xcolor}
\definecolor{mlightgray}{HTML}{DCDCDC}

% Figures
\usepackage{graphicx}
\usepackage{tikz}

\definecolor{piecolor}{HTML}{333333}

\newcommand{\pie}[1]{%
	\begin{tikzpicture}%
    \draw[piecolor] (0,0) circle (0.7ex);%
    \fill[rotate=-90,fill=piecolor] (0.7ex,0) arc (0:-#1*180:0.7ex) -- (0,0) -- cycle;%
	\end{tikzpicture}%
}

% Trees
\usepackage{forest}

% Style for edge labels
\tikzset{edge/.style = {
  midway,fill=white,font=\scriptsize
}}

\forestset{
  font=\footnotesize,
  default preamble={
    for tree = {
      l=1.5cm,
      s sep=.75cm,
      inner xsep=2mm,
      inner ysep=1mm,
      minimum height=4.75mm,
      rectangle,
      rounded corners = 2,
      fill=mlightgray,
      font=\footnotesize,
    }
  }
}

% Tables
\usepackage{longtable, tabu, booktabs}
\renewcommand{\arraystretch}{1.3} % More space between table rows
\newcolumntype{C}{>{\ttfamily}X} % New column type for code

% Ragged text
\usepackage{ragged2e}

% Code listings (minted)
\usepackage[outputdir=build]{minted}
\usemintedstyle{vs}
\newminted{text}{fontsize=\footnotesize,baselinestretch=1.05,tabsize=4,stripall,linenos}
\newminted{js}{fontsize=\footnotesize,baselinestretch=1.05,tabsize=4,stripall,linenos}
\newminted{ts}{fontsize=\footnotesize,baselinestretch=1.05,tabsize=4,stripall,linenos}
\renewcommand\listingscaption{\textsf Quelltext}
\renewcommand\listoflistingscaption{Quelltextverzeichnis}
\renewcommand{\theFancyVerbLine}{\scriptsize{\arabic{FancyVerbLine}}}

% Captions (needs to come after minted)
\usepackage[font=small]{caption}
\captionsetup{
  format=hang,
  justification=raggedright,
  singlelinecheck=off
}
\usepackage{subcaption}

% Box drawing characters
\usepackage{pmboxdraw}

% Quotes
\usepackage{csquotes}

% Strike through
\usepackage[normalem]{ulem}

% Hyphenation rules
\hyphenation{ECMAScript}
\hyphenation{JavaScript}
\hyphenation{Node}
\hyphenation{Prettier}
\hyphenation{Python}
\hyphenation{React}
\hyphenation{Reflow}
\hyphenation{Ruby}
\hyphenation{TypeScript}
\hyphenation{retainLines}
\hyphenation{false}
\hyphenation{true}
\hyphenation{unknow}
\babelhyphenation[ngerman]{Be-sucher-Ent-wurfs-musters}
\babelhyphenation[ngerman]{Kom-man-do-zei-len-pro-gramm}
\babelhyphenation[ngerman]{Team-Shirts}

% Orphans
\usepackage[all]{nowidow}

% Commands and environments
\newcommand{\code}[1]{{\texttt{#1}}}
\newcommand{\listingvspace}{\vspace{-.5\baselineskip}}
\newcommand{\type}[1]{\textsc{\MakeLowercase{\normalsize#1}}}

\newenvironment{longtabuwrap}{
  \begin{footnotesize}\begin{singlespacing}
}{
  \end{singlespacing}\end{footnotesize}
}

% Ugly fixes
\input{src/fixes}

% Document links
% Should be loaded last!
\usepackage[pdfencoding=auto, bookmarksdepth=3]{hyperref}
\hypersetup{
  hidelinks,
  pdftitle={Statische Typsysteme für JavaScript -- Entwicklung eines Babel-Plugins zur Transpilierung von Flow nach TypeScript},
  pdfauthor={Jonathan Gruber}
}

% ----------


\begin{document}
	% Numbering is invisible, but required for hyperref package
  \pagestyle{empty}
  \pagenumbering{Roman}

  \input{src/0_Frontmatter/title}
  \input{src/0_Frontmatter/abstract}
  \input{src/0_Frontmatter/toc}

  % ------------------------------

  \clearpage
  \pagestyle{headings}
  \pagenumbering{arabic}

  \input{src/1_Motivation/index}
  \input{src/2_Grundlagen/index}
  \input{src/3_Analyse/index}
  \input{src/4_Umsetzung/index}
  \input{src/5_Auswertung/index}
  \input{src/6_Fazit/index}

  % ------------------------------

  \clearpage
  \pagestyle{plain}
  \pagenumbering{Roman}

  % Smaller URLs
  \renewcommand{\UrlFont}{\small}


  \printbibliography[
    title={Quellenverzeichnis},
    notkeyword=software
  ]

  \printbibliography[
    title={Software},
    keyword=software,
    heading=subbibliography
  ]

  \listoffigures
  \listoftables
  \listoflistings
  \printendnotes

  \input{src/7_Backmatter/declaration.tex}
  \input{src/7_Backmatter/appendix.tex}
\end{document}
