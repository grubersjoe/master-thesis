\documentclass[
  abstract=on,
  BCOR=10mm,
  bibliography=totoc,
  listof=totoc,
  headsepline=on,
  numbers=noenddot,
  paper=a4,
  parskip=on,
  twoside=off,
  DIV=11,
  ngerman
]{scrreprt}

\title{Statische Typsysteme für JavaScript}
\subtitle{Entwicklung eines Transpilers von Flow nach TypeScript}
\date{\today}
\author{Jonathan Gruber}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

% "Fix" for KOMA script warning about floats
\usepackage{scrhack}

% Babel
\usepackage[ngerman]{babel}

% Fonts
\usepackage[tt=false]{libertine}
\usepackage[scale=0.8,nomap,lining]{FiraMono}

% Set headings in serif as well
\addtokomafont{disposition}{\rmfamily}

% Math
\usepackage[libertine]{newtxmath}

% Orphans
\usepackage[all]{nowidow}

% Biber (references)
\usepackage[
  backend=biber,
  backref=true,
  backrefstyle=three+,
  sortlocale=de_DE
]{biblatex}
\addbibresource{src/references.bib}

\DefineBibliographyStrings{german}{
  references = {Quellenverzeichnis}
}

% Use the main font for URLs
\urlstyle{same}

% Endnotes
\usepackage[
  backref=true,
  counter-format=roman,
  totoc=chapter,
]{enotez}

% Use a 1.5 line-height
\usepackage[onehalfspacing]{setspace}

% Header
\usepackage[
  automark,
  autooneside=false
]{scrlayer-scrpage}
\chead{}
\ihead{\leftmark}
\ohead{\rightmark}

% Remove chapter number
\renewcommand\chaptermarkformat{}

% Better spacing in lists
\usepackage{enumitem}
% \renewcommand\labelitemi{--}
\setlist{nosep}

% Figures
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{forest}

% Tables
\usepackage{tabularx, booktabs}
\renewcommand{\arraystretch}{1.25} % More space between table rows

% Code listings (minted)
\usepackage[outputdir=build]{minted}
\usemintedstyle{vs}
\newminted{text}{fontsize=\small,tabsize=4,stripall,linenos}
\newminted{js}{fontsize=\small,tabsize=4,stripall,linenos}
\newminted{ts}{fontsize=\small,tabsize=4,stripall,linenos}
\renewcommand\listingscaption{Quelltext}
\renewcommand\listoflistingscaption{Quelltextverzeichnis}
\renewcommand{\theFancyVerbLine}{\scriptsize{\arabic{FancyVerbLine}}}
\newcommand{\code}[1]{{\texttt{#1}}}

% Captions (needs to come after minted)
\usepackage[font=small]{caption}
\captionsetup{
  format=hang,
  justification=raggedright,
  singlelinecheck=off
}

% Box drawing characters
\usepackage{pmboxdraw}

% Quotes
\usepackage{csquotes}

% Strike through
\usepackage[normalem]{ulem}

% Hyphenation rules
\hyphenation{ECMAScript}
\hyphenation{JavaScript}
\hyphenation{Prettier}
\hyphenation{Python}
\hyphenation{Reflow}
\hyphenation{Ruby}
\hyphenation{TypeScript}
\hyphenation{retainLines}
\hyphenation{unknow}
\babelhyphenation[ngerman]{Be-sucher-Ent-wurfs-musters}
\babelhyphenation[ngerman]{Kom-man-do-zei-len-pro-gramm}
% Orphans
\usepackage[all]{nowidow}

% The following ensures that only straight quotes are used inside of \texttt
\usepackage{upquote}
\usepackage{etoolbox}

\robustify{\texttt}
\let\originaltexttt\texttt

\begingroup
\catcode`'=\active
\catcode``=\active
\globaldefs1
\makeatletter
\renewrobustcmd{\texttt}[1]{%
  {%
  \everyeof{\noexpand}\endlinechar-1
  \expandafter\catcode\string``=\active
  \expandafter\catcode\string`'=\active
  \let'\textquotesingle
  \let`\textasciigrave
  \ifx\encodingdefault\upquote@OTone
    \ifx\ttdefault\upquote@cmtt
    \def'{\char13 }\def`{\char18 }%
    \fi
  \fi
  \scantokens{\originaltexttt{#1}}%
  }%
}%
\endgroup


% Document links
% Should be loaded last!
\usepackage[pdfencoding=auto]{hyperref}
\hypersetup{
  hidelinks,
  pdftitle={Statische Typsysteme für JavaScript -- Entwicklung eines Transpilers von Flow nach TypeScript -- Jonathan Gruber},
  pdfauthor={Jonathan Gruber}
}

% ----------

\begin{document}
	% Numbering is invisible, but required for hyperref package
  \pagestyle{empty}
  \pagenumbering{Roman}

  \input{src/Title/index}
  \input{src/Abstract/index}

  {
    % Apply empty page style to multiple pages
    \renewcommand{\thispagestyle}[1]{}
    \setcounter{tocdepth}{2}
    \tableofcontents
  }

  % ------------------------------

  \clearpage
  \pagestyle{headings}
  \pagenumbering{arabic}

  \input{src/1_Motivation/index}
  \input{src/2_Grundlagen/index}
  \input{src/3_Analyse/index}
  \input{src/4_Umsetzung/index}
  \input{src/5_Durchfuehrung/index}
  \input{src/6_Auswertung/index}
  \input{src/7_Fazit/index}

  % ------------------------------

  \clearpage
  \pagestyle{plain}
  \pagenumbering{Roman}

  % Smaller URLs
  \renewcommand{\UrlFont}{\small}


  \printbibliography[
    title={Quellenverzeichnis},
    notkeyword=software
  ]

  \printbibliography[
    title={Software},
    keyword=software,
    heading=subbibliography
  ]

  \listoffigures
  \listoftables
  \listoflistings
  \printendnotes

  \input{src/Appendix/declaration.tex}

  \appendix
  \input{src/Appendix/index.tex}
\end{document}
